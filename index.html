<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶∏ Dream OS v3.2 - SIF Al Fikri General Affairs System</title>
    
    <!-- PWA CONFIG -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2D5D4B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dream OS">
    
    <!-- FONTS & ICONS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SPLASH SCREEN CSS -->
    <style>
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }
        
        .splash-logo {
            font-size: 4rem;
            color: #FFD700;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .splash-text {
            color: #FFD700;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .splash-subtext {
            color: #94A3B8;
            font-size: 1rem;
        }
        
        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
    </style>
    
    <!-- MAIN STYLES -->
    <style>
        /* ========== v3.2 HIGH-END UX ANIMATIONS ========== */
        .button-high-end {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .button-high-end::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .button-high-end:active::after {
            width: 300px;
            height: 300px;
        }

        /* MODAL ANIMATIONS */
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }

        @keyframes shrink {
            from { width: 100%; }
            to { width: 0%; }
        }

        /* KILL SWITCH */
        .no-animations * {
            animation: none !important;
            transition: none !important;
        }

        /* ========== ROOT VARIABLES ========== */
        :root {
            --palestine-black: #000000;
            --indonesia-red: #CE1126;
            --palestine-green: #006400;
            --gold: #FFD700;
            --light-green: #90EE90;
            --light-red: #FF6B6B;
            --bg-dark: #0F172A;
            --card-bg: rgba(30, 41, 59, 0.8);
            --text-light: #F8FAFC;
            --text-gray: #94A3B8;
            
            /* Healing Green Variables */
            --hijau-dasar: #E8F5E9;
            --hijau-soft: #C8E6C9;
            --hijau-medium: #A5D6A7;
            --hijau-strong: #81C784;
            --hijau-dark: #4CAF50;
            --emas: #D4AF37;
            --text-dark: #2C3E50;
            --merah: #D32F2F;
        }

        /* ========== GLOBAL STYLES ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            display: none; /* Sembunyikan dulu sampai splash selesai */
        }

        /* ========== MAIN CONTAINER ========== */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(15, 23, 42, 0.7);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 215, 0, 0.1);
            backdrop-filter: blur(10px);
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ========== REVISED HEADER SECTION ========== */
        .spiritual-header {
            background: linear-gradient(135deg, 
                var(--palestine-black) 0%, 
                var(--indonesia-red) 50%, 
                var(--palestine-green) 100%);
            background-size: 400% 400%;
            animation: gradientFlow 15s ease infinite;
            padding: 30px 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Lafadz Allah dan Muhammad di atas */
        .lafadz-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 10px;
        }

        .lafadz-arabic {
            font-family: 'Amiri', serif;
            font-size: 3.5rem;
            color: var(--gold);
            text-shadow: 0 5px 15px rgba(0,0,0,0.5);
            flex: 1;
        }

        .lafadz-arabic:first-child {
            text-align: left;
        }

        .lafadz-arabic:last-child {
            text-align: right;
        }

        /* Bendera di tengah */
        .flags-center {
            font-size: 3.5rem;
            margin: 10px 0;
            animation: float 3s ease-in-out infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex: 1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Teks di bawah bendera */
        .header-subtitle {
            font-size: 1.4rem;
            color: var(--gold);
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Bismillah dan Shalawat */
        .spiritual-text-container {
            margin: 25px 0;
        }

        .bismillah {
            font-family: 'Amiri', serif;
            font-size: 2rem;
            color: white;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .shalawat {
            font-family: 'Amiri', serif;
            font-size: 1.6rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 15px;
        }

        /* Tribute to Leaders */
        .tribute-section {
            background: rgba(255, 215, 0, 0.15);
            border-radius: 15px;
            padding: 25px;
            margin: 25px auto;
            max-width: 900px;
            border: 2px solid var(--gold);
            backdrop-filter: blur(10px);
        }

        .tribute-title {
            color: var(--gold);
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .leader-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid;
            transition: transform 0.3s;
        }

        .leader-card:hover {
            transform: translateY(-5px);
        }

        .leader-card.hanung {
            border-color: var(--palestine-green);
            background: rgba(0, 100, 64, 0.2);
        }

        .leader-card.erwin {
            border-color: var(--indonesia-red);
            background: rgba(206, 17, 38, 0.2);
        }

        .leader-name {
            font-size: 1.5rem;
            color: var(--gold);
            font-weight: 700;
            margin-bottom: 5px;
        }

        .leader-title {
            font-size: 1.1rem;
            color: var(--light-green);
            font-style: italic;
            margin-bottom: 8px;
        }

        .leader-desc {
            font-size: 0.95rem;
            color: var(--text-gray);
        }

        /* Arabic Quote */
        .quote-section {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 30px auto;
            max-width: 800px;
            border: 2px dashed var(--gold);
        }

        .arabic-quote {
            font-family: 'Amiri', serif;
            font-size: 1.6rem;
            color: var(--gold);
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .quote-translation {
            font-size: 1.2rem;
            color: var(--gold);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .quote-desc {
            font-size: 0.95rem;
            color: var(--text-gray);
        }

        /* Main Title */
        .main-title {
            margin: 30px 0;
        }

        .dream-title {
            font-size: 3.2rem;
            background: linear-gradient(90deg, var(--gold), white, var(--light-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 5px 20px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-gray);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* Dream Team */
        .dream-team-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin: 30px auto;
            max-width: 1000px;
        }

        .team-title {
            font-size: 1.9rem;
            color: var(--gold);
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }

        .team-members {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        .team-member {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid;
            transition: all 0.3s;
        }

        .team-member:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .member-m { border-color: var(--light-green); }
        .member-d { border-color: var(--light-red); }
        .member-q { border-color: var(--gold); }

        .member-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .member-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .member-role {
            font-size: 0.95rem;
            color: var(--text-gray);
        }

        .team-slogan {
            font-size: 1.3rem;
            color: var(--gold);
            text-align: center;
            font-style: italic;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Closing */
        .closing-section {
            font-size: 1.4rem;
            color: white;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        /* ========== MAIN MENU SECTION ========== */
        .main-menu-section {
            padding: 50px 40px;
            background: rgba(15, 23, 42, 0.9);
        }

        .section-title {
            font-size: 2.2rem;
            color: var(--gold);
            margin-bottom: 40px;
            text-align: center;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .menu-card {
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9));
            border-radius: 20px;
            padding: 35px 30px;
            text-align: center;
            border: 1px solid rgba(255, 215, 0, 0.1);
            cursor: pointer;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.05), transparent);
            transition: 0.6s;
        }

        .menu-card:hover::before {
            left: 100%;
        }

        .menu-card:hover {
            transform: translateY(-15px);
            border-color: var(--gold);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .menu-icon {
            font-size: 3.5rem;
            margin-bottom: 25px;
            color: var(--gold);
        }

        .menu-card.booking .menu-icon { color: var(--light-green); }
        .menu-card.k3 .menu-icon { color: var(--light-red); }
        .menu-card.inventaris .menu-icon { color: var(--gold); }
        .menu-card.calendar .menu-icon { color: #06B6D4; }
        .menu-card.backup .menu-icon { color: #8B5CF6; }
        .menu-card.qrcode .menu-icon { color: #4CAF50; }
        .menu-card.admin .menu-icon { color: #F59E0B; }

        .menu-card h3 {
            font-size: 1.7rem;
            margin-bottom: 15px;
            color: white;
        }

        .menu-card p {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .menu-note {
            display: block;
            margin-top: 15px;
            color: #F59E0B;
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* ========== FORM STYLES ========== */
        .form-container {
            display: none;
            padding: 40px;
            background: rgba(30, 41, 59, 0.95);
            border-radius: 20px;
            margin: 20px;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-title {
            color: var(--gold);
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 2rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--light-green);
            font-size: 1rem;
        }

        .form-group label i {
            margin-right: 8px;
            color: var(--gold);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--gold);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        /* Grid untuk tanggal & waktu */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        /* Emergency Box */
        .emergency-box {
            background: rgba(211, 47, 47, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            text-align: center;
            border: 1px solid rgba(211, 47, 47, 0.3);
        }

        .emergency-box strong {
            color: var(--light-red);
            display: block;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .emergency-box a {
            color: var(--light-red);
            text-decoration: none;
            font-weight: 600;
        }

        .emergency-box a:hover {
            text-decoration: underline;
        }

        /* Submit Buttons */
        .submit-btn {
            background: linear-gradient(to right, var(--palestine-green), var(--hijau-dark));
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            margin-top: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 8px 20px rgba(0, 100, 0, 0.3);
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0, 100, 0, 0.4);
        }

        .submit-btn.k3-btn {
            background: linear-gradient(to right, #FF9800, #FFB74D);
        }

        /* Back Button */
        .back-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* ========== CALENDAR EXTENDED STYLES ========== */
        .calendar-full-container {
            background: rgba(30, 41, 59, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid var(--gold);
        }

        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .calendar-nav-btn {
            background: rgba(255, 215, 0, 0.1);
            color: var(--gold);
            border: 1px solid var(--gold);
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .calendar-nav-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }

        .calendar-current-month {
            font-size: 1.8rem;
            color: white;
            font-weight: 700;
            text-align: center;
            flex-grow: 1;
        }

        .calendar-days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .day-header {
            text-align: center;
            color: var(--gold);
            font-weight: 600;
            padding: 10px;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        .calendar-days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day-box {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .calendar-day-box:hover {
            transform: translateY(-5px);
            border-color: var(--gold);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .calendar-day-box.empty {
            background: rgba(144, 238, 144, 0.1);
            border-color: rgba(144, 238, 144, 0.3);
        }

        .calendar-day-box.partial {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
        }

        .calendar-day-box.full {
            background: rgba(255, 107, 107, 0.1);
            border-color: rgba(255, 107, 107, 0.3);
        }

        .calendar-day-box.weekend {
            background: rgba(206, 17, 38, 0.1);
            border-color: rgba(206, 17, 38, 0.3);
        }

        .day-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
        }

        .day-events {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .event-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--palestine-green);
        }

        .event-dot.k3 {
            background: var(--light-red);
        }

        .event-dot.booking {
            background: var(--light-green);
        }

        .day-booking-count {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--gold);
            color: black;
            font-size: 0.7rem;
            font-weight: 700;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ========== QR CODE GENERATOR STYLES ========== */
        .qr-generator-container {
            background: linear-gradient(135deg, rgba(45, 93, 75, 0.9), rgba(30, 41, 59, 0.9));
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid var(--gold);
        }

        .qr-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .qr-type-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .qr-type-card:hover {
            transform: translateY(-5px);
            border-color: var(--gold);
        }

        .qr-type-card.active {
            border-color: var(--palestine-green);
            background: rgba(0, 100, 64, 0.2);
        }

        .qr-type-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .qr-type-card.booking .qr-type-icon { color: var(--light-green); }
        .qr-type-card.facility .qr-type-icon { color: var(--gold); }
        .qr-type-card.emergency .qr-type-icon { color: var(--light-red); }
        .qr-type-card.custom .qr-type-icon { color: #8B5CF6; }

        .qr-preview-container {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            margin: 25px 0;
        }

        .qr-code-image {
            width: 250px;
            height: 250px;
            border-radius: 15px;
            border: 5px solid white;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            margin: 0 auto 20px;
        }

        .qr-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .qr-action-btn {
            background: var(--palestine-green);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .qr-action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 100, 0, 0.3);
        }

        .qr-action-btn.download {
            background: var(--gold);
            color: black;
        }

        .qr-action-btn.print {
            background: #6D28D9;
        }

        /* ========== BACKUP SYSTEM STYLES ========== */
        .backup-container {
            background: rgba(30, 41, 59, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #8B5CF6;
        }

        .backup-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .backup-option {
            background: rgba(139, 92, 246, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .backup-option:hover {
            transform: translateY(-5px);
            border-color: #8B5CF6;
        }

        .backup-icon {
            font-size: 3rem;
            color: #8B5CF6;
            margin-bottom: 15px;
        }

        .backup-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .backup-stat {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-gray);
        }

        /* ========== ADMIN PANEL STYLES ========== */
        .admin-container {
            background: rgba(30, 41, 59, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #F59E0B;
        }

        .admin-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .admin-stat-card {
            background: rgba(245, 158, 11, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .admin-stat-icon {
            font-size: 2.5rem;
            color: #F59E0B;
            margin-bottom: 15px;
        }

        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .admin-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            background: rgba(245, 158, 11, 0.2);
            border-color: #F59E0B;
        }

        /* ========== FOOTER ========== */
        .footer {
            background: rgba(15, 23, 42, 0.95);
            padding: 40px;
            text-align: center;
            border-top: 2px solid rgba(255, 215, 0, 0.2);
        }

        .footer-title {
            font-size: 1.8rem;
            color: var(--gold);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 30px 0;
            text-align: left;
        }

        .footer-column h4 {
            color: var(--light-green);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .footer-column p {
            color: var(--text-gray);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .copyright {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        .copyright a {
            color: var(--gold);
            text-decoration: none;
        }

        /* ========== UX PREFERENCES PANEL ========== */
        .ux-panel {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 15px;
            border: 1px dashed var(--gold);
        }

        .ux-panel h4 {
            color: var(--gold);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .ux-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .ux-toggle span {
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        .wisdom-quote {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.03);
            border-radius: 10px;
            border-left: 3px solid var(--gold);
        }

        .wisdom-quote p {
            color: var(--gold);
            font-size: 0.8rem;
            margin: 0;
            font-style: italic;
            text-align: center;
        }

        /* ========== INSTALL BUTTON ========== */
        .install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--palestine-green), var(--hijau-dark));
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 100, 0, 0.3);
            display: none;
            z-index: 1000;
            align-items: center;
            gap: 10px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .lafadz-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .lafadz-arabic {
                font-size: 2.5rem;
                text-align: center !important;
            }
            
            .flags-center {
                font-size: 2.5rem;
            }
            
            .bismillah { font-size: 1.5rem; }
            .shalawat { font-size: 1.2rem; }
            .dream-title { font-size: 2.2rem; }
            .main-menu-section { padding: 30px 20px; }
            .menu-grid { grid-template-columns: 1fr; }
            .team-members { grid-template-columns: 1fr; }
            .footer-grid { grid-template-columns: 1fr; text-align: center; }
            .form-container { padding: 20px; margin: 10px; }
            .form-grid { grid-template-columns: 1fr; }
            .calendar-days-grid { grid-template-columns: repeat(7, 1fr); gap: 8px; }
            .calendar-day-box { padding: 8px; }
            .day-number { font-size: 1.2rem; }
            .qr-types-grid, .backup-options, .admin-stats-grid {
                grid-template-columns: 1fr;
            }
            .qr-code-image { width: 200px; height: 200px; }
            .install-btn {
                bottom: 10px;
                right: 10px;
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            .ux-panel {
                padding: 15px;
                margin: 15px 0;
            }
        }

        /* ========== SCROLLBAR ========== */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #FFC107;
        }
    </style>
</head>
<body>
    <!-- SPLASH SCREEN -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-logo">ü¶∏</div>
        <div class="splash-text">Dream OS v3.2</div>
        <div class="splash-subtext">SIF Al Fikri General Affairs System</div>
        <div class="splash-subtext loading-dots">Loading</div>
    </div>

    <!-- INSTALL BUTTON -->
    <button class="install-btn" id="installButton" onclick="installApp()">
        <i class="fas fa-download"></i> Install App
    </button>

    <!-- ========== MAIN CONTAINER ========== -->
    <div class="main-container">
        
        <!-- ========== REVISED HEADER SECTION ========== -->
        <div class="spiritual-header">
            <!-- Lafadz Allah dan Muhammad di atas -->
            <div class="lafadz-container">
                <div class="lafadz-arabic">ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸå</div>
                <div class="flags-center">
                    <span>üáµüá∏</span>
                    <span>‚ù§Ô∏è</span>
                    <span>üáÆüá©</span>
                </div>
                <div class="lafadz-arabic">Ô∑≤</div>
            </div>
            
            <!-- Teks General Affairs Department -->
            <div class="header-subtitle">
                GENERAL AFFAIRS DEPARTMENT
            </div>
            
            <!-- Bismillah dan Shalawat -->
            <div class="spiritual-text-container">
                <div class="bismillah">
                    ÿ®Ÿêÿ≥ŸíŸÖŸê Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê
                </div>
                
                <div class="shalawat">
                    ÿßŸéŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸéŸâ ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç ŸàŸéÿπŸéŸÑŸéŸâ ÿ¢ŸÑŸê ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç
                </div>
            </div>
            
            <!-- Tribute to Leaders -->
            <div class="tribute-section">
                <div class="tribute-title">
                    üèÜ HONORING OUR GENERAL AFFAIRS LEADERS üèÜ
                </div>
                
                <!-- Pak Hanung -->
                <div class="leader-card hanung">
                    <div class="leader-name">
                        <span style="color: var(--light-green);">üåü</span> Mr. Hanung Budianto, S.E.
                    </div>
                    <div class="leader-title">
                        "The General Affairs Commander" ‚Ä¢ Head of General Affairs
                    </div>
                    <div class="leader-desc">
                        Chief Administrator & Strategic Planner of SIF Al Fikri
                    </div>
                </div>
                
                <!-- Pak Erwin -->
                <div class="leader-card erwin">
                    <div class="leader-name">
                        <span style="color: var(--light-red);">üéØ</span> Mr. Erwin Syah
                    </div>
                    <div class="leader-title">
                        "The Operations Maestro" ‚Ä¢ General Affairs Coordinator
                    </div>
                    <div class="leader-desc">
                        Master of Daily Operations & Facility Excellence
                    </div>
                </div>
                
                <div style="font-size: 0.9rem; color: var(--text-gray); margin-top: 15px; font-style: italic;">
                    This digital system is dedicated to streamlining your General Affairs operations
                </div>
            </div>
            
            <!-- Arabic Quote -->
            <div class="quote-section">
                <div class="arabic-quote">
                    ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê ÿ£ŸéŸÜŸíŸÅŸéÿπŸèŸáŸèŸÖŸí ŸÑŸêŸÑŸÜŸéŸëÿßÿ≥Ÿê
                </div>
                <div class="quote-translation">
                    "The Best Among People Are Those Who Benefit Others"
                </div>
                <div class="quote-desc">
                    Guiding principle for SIF Al Fikri's General Affairs Department
                </div>
            </div>
            
            <!-- Main Title -->
            <div class="main-title">
                <h1 class="dream-title">
                    ü¶∏ DREAM OS v3.2
                </h1>
                <div class="subtitle">
                    GENERAL AFFAIRS DIGITAL MANAGEMENT SYSTEM
                </div>
            </div>
            
            <!-- Dream Team -->
            <div class="dream-team-section">
                <div class="team-title">
                    ‚ö° THE DREAM TEAM ‚ö°
                </div>
                
                <div class="team-members">
                    <div class="team-member member-m">
                        <div class="member-icon">‚ö°</div>
                        <div class="member-name">Mr. M</div>
                        <div class="member-role">System Architect</div>
                    </div>
                    
                    <div class="team-member member-d">
                        <div class="member-icon">üéØ</div>
                        <div class="member-name">Mr. DSeek</div>
                        <div class="member-role">Lead Developer</div>
                    </div>
                    
                    <div class="team-member member-q">
                        <div class="member-icon">üí¨</div>
                        <div class="member-name">Mrs. Qwen</div>
                        <div class="member-role">AI & Strategy Consultant<br><small>(The Vocal One bawelüòÑ)</small></div>
                    </div>
                </div>
                
                <div class="team-slogan">
                    Powered by The Soul of Shalawat ‚Ä¢ Built for General Affairs Excellence
                </div>
            </div>
            
            <!-- Closing -->
            <div class="closing-section">
                üïå Dedicated to Streamlining SIF Al Fikri's General Affairs üïå
            </div>
        </div>
        
        <!-- ========== MAIN MENU SECTION ========== -->
        <div class="main-menu-section" id="mainMenu">
            <h2 class="section-title">
                üöÄ SYSTEM FEATURES
            </h2>
            
            <div class="menu-grid">
                <!-- Booking System -->
                <div class="menu-card booking" onclick="showForm('booking')">
                    <div class="menu-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h3>Form Booking</h3>
                    <p>Booking fasilitas sekolah dengan SOP lengkap dan validasi otomatis. Anti double-booking system dan integrasi WhatsApp langsung ke Pak Erwin.</p>
                    <span class="menu-note">
                        <i class="fas fa-clock"></i> Jam operasional: 07.30 - 16.00 WIB
                    </span>
                </div>
                
                <!-- K3 Reporting -->
                <div class="menu-card k3" onclick="showForm('k3')">
                    <div class="menu-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3>Form K3</h3>
                    <p>Laporan Kerusakan, Kehilangan, dan Kejadian penting di lingkungan sekolah. Dilengkapi dengan bukti foto dan notifikasi real-time.</p>
                    <span class="menu-note">
                        <i class="fas fa-shield-alt"></i> Untuk hal-hal yang perlu penanganan segera
                    </span>
                </div>
                
                <!-- Inventaris -->
                <div class="menu-card inventaris" onclick="requestPassword()">
                    <div class="menu-icon">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <h3>Form Inventaris</h3>
                    <p>Data inventaris sekolah yang terproteksi dengan sistem password. Hanya admin terpilih yang dapat mengakses database lengkap.</p>
                    <span class="menu-note">
                        <i class="fas fa-lock"></i> Password protected - Admin only
                    </span>
                </div>
                
                <!-- Calendar 30 Days -->
                <div class="menu-card calendar" onclick="showFullCalendar()">
                    <div class="menu-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h3>Kalender 30 Hari</h3>
                    <p>Lihat jadwal booking 30 hari ke depan dalam tampilan visual yang interaktif. Dapat melihat hari yang penuh, sebagian, atau kosong.</p>
                    <span class="menu-note">
                        <i class="fas fa-eye"></i> Preview availability for planning
                    </span>
                </div>
                
                <!-- QR Code Generator -->
                <div class="menu-card qrcode" onclick="showQRGenerator()">
                    <div class="menu-icon">
                        <i class="fas fa-qrcode"></i>
                    </div>
                    <h3>QR Code Generator</h3>
                    <p>Buat QR Code untuk booking, fasilitas, emergency contact, dan custom teks. Download dan share dengan mudah.</p>
                    <span class="menu-note">
                        <i class="fas fa-bolt"></i> Instant generate & download
                    </span>
                </div>
                
                <!-- Data Backup -->
                <div class="menu-card backup" onclick="showBackupSystem()">
                    <div class="menu-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3>Data Backup & Export</h3>
                    <p>Backup otomatis semua data ke format JSON/CSV untuk migrasi ke Uniapp. Ekspor data booking, K3, dan inventaris dengan satu klik.</p>
                    <span class="menu-note">
                        <i class="fas fa-file-export"></i> Export to JSON, CSV, PDF
                    </span>
                </div>
                
                <!-- Admin Panel -->
                <div class="menu-card admin" onclick="showAdminPanel()">
                    <div class="menu-icon">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h3>Admin Panel</h3>
                    <p>Akses khusus untuk pengelolaan sistem lengkap. Monitoring real-time, analytics, dan pengaturan sistem.</p>
                    <span class="menu-note">
                        <i class="fas fa-chart-line"></i> Real-time analytics & controls
                    </span>
                </div>
            </div>
            
            <!-- UX PREFERENCES PANEL -->
            <div class="ux-panel" id="uxPreferences">
                <h4><i class="fas fa-sliders-h"></i> Pengaturan Pengalaman</h4>
                
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <label class="ux-toggle">
                        <input type="checkbox" id="hapticToggle" checked style="accent-color: var(--palestine-green);">
                        <span><i class="fas fa-vibrate"></i> Haptic Feedback</span>
                    </label>
                    
                    <label class="ux-toggle">
                        <input type="checkbox" id="swipeToggle" checked style="accent-color: var(--palestine-green);">
                        <span><i class="fas fa-hand-pointer"></i> Swipe Navigation</span>
                    </label>
                    
                    <label class="ux-toggle">
                        <input type="checkbox" id="animToggle" checked style="accent-color: var(--palestine-green);">
                        <span><i class="fas fa-film"></i> Animations</span>
                    </label>
                </div>
                
                <!-- WISDOM QUOTE -->
                <div class="wisdom-quote">
                    <p>
                        <i class="fas fa-quote-left" style="color: var(--palestine-green); margin-right: 5px;"></i>
                        Kemewahan adalah pilihan. Kesederhanaan adalah kehormatan.
                        <i class="fas fa-quote-right" style="color: var(--palestine-green); margin-left: 5px;"></i>
                    </p>
                </div>
                
                <div style="margin-top: 15px;">
                    <button onclick="resetUXPreferences()" 
                            style="background: none; border: 1px solid var(--text-gray);
                                   color: var(--text-gray); padding: 8px 15px; border-radius: 20px;
                                   font-size: 0.8rem; cursor: pointer;">
                        <i class="fas fa-redo"></i> Reset ke Default
                    </button>
                </div>
            </div>
            
            <!-- Install PWA Info -->
            <div style="text-align: center; margin-top: 40px; padding: 20px; background: rgba(255,215,0,0.1); border-radius: 15px;">
                <h4 style="color: var(--gold); margin-bottom: 10px;">
                    <i class="fas fa-mobile-alt"></i> Install as App
                </h4>
                <p style="color: var(--text-gray); font-size: 0.9rem;">
                    Untuk pengalaman terbaik, install Dream OS sebagai aplikasi di homescreen HP Anda.
                    Buka di Chrome/Safari ‚Üí Tap menu (‚ãÆ) ‚Üí "Add to Home Screen"
                </p>
            </div>
        </div>
        
        <!-- ========== FORM CONTAINERS ========== -->
        
        <!-- FORM BOOKING -->
        <div id="bookingForm" class="form-container">
            <h2 class="form-title"><i class="fas fa-calendar-alt"></i> Form Booking Fasilitas</h2>
            
            <form id="bookingFormElement" onsubmit="submitBooking(event)">
                <div class="form-group">
                    <label for="nama"><i class="fas fa-user"></i> Nama Lengkap *</label>
                    <input type="text" id="nama" placeholder="Masukkan nama lengkap" required>
                </div>
                
                <div class="form-group">
                    <label for="divisi"><i class="fas fa-building"></i> Divisi *</label>
                    <select id="divisi" required>
                        <option value="">-- Pilih Divisi --</option>
                        <option value="SD">SD</option>
                        <option value="SMP">SMP</option>
                        <option value="SMA">SMA</option>
                        <option value="UMUM">UMUM</option>
                        <option value="OSIS">OSIS</option>
                        <option value="GURU">GURU</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="whatsapp"><i class="fab fa-whatsapp"></i> Nomor WhatsApp *</label>
                    <input type="tel" id="whatsapp" placeholder="08123456789" pattern="[0-9]{10,13}" required>
                </div>
                
                <div class="form-group">
                    <label for="sarana"><i class="fas fa-building"></i> Sarana yang Dipesan *</label>
                    <select id="sarana" required>
                        <option value="">-- Pilih Sarana --</option>
                        <optgroup label="üè¢ Aula & Serbaguna">
                            <option value="Aula SMP - sound, lighting, ac, projector (include)">1. Aula SMP - sound, lighting, ac, projector (include)</option>
                            <option value="Aula SMA - sound, projector (include)">2. Aula SMA - sound, projector (include)</option>
                            <option value="Saung Besar - sound (include)">3. Saung Besar - sound (include)</option>
                            <option value="Saung Kecil">4. Saung Kecil</option>
                            <option value="Masjid - sound (üîß MAINTENANCE - TIDAK BISA DIBOOKING)" disabled style="color: #FF6B6B; background: rgba(255, 107, 107, 0.1);">
                                5. Masjid - sound (üîß MAINTENANCE - TIDAK BISA DIBOOKING)
                            </option>
                            <option value="Serbaguna - sound (include)">6. Serbaguna - sound (include)</option>
                        </optgroup>
                        <optgroup label="üíª Lab Komputer">
                            <option value="Labkom SD">7. Labkom SD</option>
                            <option value="Labkom SMP">8. Labkom SMP</option>
                            <option value="Labkom SMA">9. Labkom SMA</option>
                        </optgroup>
                        <optgroup label="üèÄ Lapangan & Area">
                            <option value="Lapangan Volley">10. Lapangan Volley</option>
                            <option value="Lapangan Basket">11. Lapangan Basket</option>
                            <option value="Lapangan SMA">12. Lapangan SMA</option>
                            <option value="Lapangan Tanah">13. Lapangan Tanah</option>
                        </optgroup>
                        <optgroup label="üçΩÔ∏è Kantin & Perpustakaan">
                            <option value="Kantin SMP">14. Kantin SMP</option>
                            <option value="Kantin SMA">15. Kantin SMA</option>
                            <option value="Perpus SD">16. Perpus SD</option>
                            <option value="Perpus SMP">17. Perpus SMP</option>
                            <option value="Perpus SMA">18. Perpus SMA</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tanggal"><i class="fas fa-calendar-day"></i> Tanggal *</label>
                        <input type="date" id="tanggal" required>
                    </div>
                    <div class="form-group">
                        <label for="waktuMulai"><i class="fas fa-clock"></i> Waktu Mulai *</label>
                        <input type="time" id="waktuMulai" min="07:30" max="16:00" required>
                    </div>
                    <div class="form-group">
                        <label for="waktuSelesai"><i class="fas fa-clock"></i> Waktu Selesai *</label>
                        <input type="time" id="waktuSelesai" min="07:30" max="16:00" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="keterangan"><i class="fas fa-sticky-note"></i> Keterangan Kegiatan *</label>
                    <textarea id="keterangan" rows="3" placeholder="Contoh: Rapat OSIS, Pelajaran TIK, Lomba, dll." required></textarea>
                </div>
                
                <button type="submit" class="submit-btn">
                    <i class="fab fa-whatsapp"></i> Kirim ke Pak Erwinsyah
                </button>
                
                <button type="button" onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            </form>
            
            <!-- ========== CANCEL BOOKING BUTTON ========== -->
            <div style="text-align: center; margin: 30px 0;">
                <button onclick="smartCancelBooking()"
                        style="
                            width: 90%;
                            max-width: 400px;
                            margin: 0 auto;
                            display: block;
                            background: linear-gradient(to right, #FF5252, #FF8A80);
                            color: white;
                            border: none;
                            padding: 15px;
                            border-radius: 10px;
                            font-size: 1rem;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 5px 15px rgba(255, 82, 82, 0.3);
                        ">
                    üö´ Batalkan Booking
                </button>
                <p style="color: var(--text-gray); font-size: 0.9rem; margin-top: 10px;">
                    Klik untuk buka WhatsApp ke Pak Erwin dengan template
                </p>
            </div>
        </div>
        
        <!-- FORM K3 -->
        <div id="k3Form" class="form-container">
            <h2 class="form-title"><i class="fas fa-exclamation-triangle"></i> Form K3 (Laporan)</h2>
            
            <div class="emergency-box">
                <strong>üÜò Emergency Contact:</strong><br>
                Pak Erwinsyah: 
                <a href="https://wa.me/628886183954" style="color:var(--light-red); text-decoration:none; font-weight:600;">
                    üì± 0888-6183-954
                </a><br>
                <small>(Jam kerja: 07.30-16.00 WIB)</small>
            </div>
            
            <!-- History Button -->
            <button onclick="showK3FotoHistory()" 
                    style="
                        width: 100%;
                        background: rgba(255, 215, 0, 0.1);
                        color: var(--gold);
                        border: 1px solid var(--gold);
                        padding: 12px 24px;
                        border-radius: 10px;
                        cursor: pointer;
                        font-size: 1rem;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                        margin: 20px 0;
                        transition: all 0.3s;
                    "
                    onmouseover="this.style.background='rgba(255, 215, 0, 0.2)';"
                    onmouseout="this.style.background='rgba(255, 215, 0, 0.1)';">
                <i class="fas fa-history"></i> Lihat History Foto K3
            </button>
            
            <form id="k3FormElement" onsubmit="submitK3(event)" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="jenisK3"><i class="fas fa-clipboard-list"></i> Jenis Laporan *</label>
                    <select id="jenisK3" required>
                        <option value="">-- Pilih Jenis --</option>
                        <option value="Kerusakan">Kerusakan (diteruskan ke Maintenance)</option>
                        <option value="Kehilangan">Kehilangan (diteruskan ke Security)</option>
                        <option value="Kebersihan">Kebersihan (kebun, toilet, sampah)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="lokasiK3"><i class="fas fa-map-marker-alt"></i> Lokasi Kejadian *</label>
                    <input type="text" id="lokasiK3" placeholder="Contoh: Lab Komputer 1, Aula SMP" required>
                </div>
                
                <div class="form-group">
                    <label for="barangK3"><i class="fas fa-box"></i> Barang / Jenis Masalah *</label>
                    <input type="text" id="barangK3" placeholder="Contoh: AC rusak, Kursi patah" required>
                </div>
                
                <div class="form-group">
                    <label for="deskripsiK3"><i class="fas fa-align-left"></i> Deskripsi Detail *</label>
                    <textarea id="deskripsiK3" rows="4" placeholder="Jelaskan secara detail apa yang terjadi..." required></textarea>
                </div>
                
                <!-- ========== TAMBAHAN: UPLOAD FOTO ========== -->
                <div class="form-group">
                    <label for="fotoK3"><i class="fas fa-camera"></i> Upload Foto Bukti (Opsional)</label>
                    <div style="
                        background: rgba(255, 215, 0, 0.05);
                        border: 2px dashed var(--gold);
                        border-radius: 15px;
                        padding: 25px;
                        margin: 10px 0;
                        text-align: center;
                        cursor: pointer;
                        transition: all 0.3s;
                    " 
                    onclick="document.getElementById('fotoK3').click()"
                    onmouseover="this.style.background='rgba(255, 215, 0, 0.1)'; this.style.borderColor='var(--light-green)';"
                    onmouseout="this.style.background='rgba(255, 215, 0, 0.05)'; this.style.borderColor='var(--gold)';">
                        <div style="font-size: 3rem; color: var(--gold); margin-bottom: 15px;">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div style="font-size: 1.2rem; color: var(--gold); margin-bottom: 15px;">
                            Klik untuk upload foto
                        </div>
                        <small style="color: var(--text-gray); display: block;">
                            Maksimal 5MB (JPG, PNG, JPEG)
                        </small>
                        <input type="file" id="fotoK3" style="display: none;" 
                               accept="image/*" capture="environment" onchange="previewK3Foto(event)">
                    </div>
                    <small style="color: var(--text-gray); display: block; margin-top: 5px;">
                        <i class="fas fa-info-circle"></i> Foto akan dikirim ke WhatsApp untuk bukti visual
                    </small>
                </div>
                
                <!-- Preview Foto -->
                <div id="fotoPreviewContainer" style="display: none; margin: 25px 0; text-align: center;">
                    <p style="color: var(--light-green); margin-bottom: 15px; font-size: 1.1rem;">
                        <i class="fas fa-image"></i> Preview Foto:
                    </p>
                    <img id="fotoPreview" src="#" alt="Preview Foto" 
                         style="
                            max-width: 100%;
                            max-height: 300px;
                            border-radius: 12px;
                            border: 3px solid var(--gold);
                            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
                            margin: 15px 0;
                         ">
                    <button type="button" onclick="removeFoto()" 
                            style="
                                background: linear-gradient(to right, #FF5252, #FF8A80);
                                color: white;
                                border: none;
                                padding: 10px 20px;
                                border-radius: 8px;
                                font-weight: 600;
                                cursor: pointer;
                                display: inline-flex;
                                align-items: center;
                                gap: 8px;
                                margin-top: 10px;
                                transition: all 0.3s;
                            "
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 20px rgba(255, 82, 82, 0.4)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                        <i class="fas fa-trash"></i> Hapus Foto
                    </button>
                </div>
                <!-- ========== END TAMBAHAN ========== -->
                
                <button type="submit" class="submit-btn k3-btn">
                    <i class="fas fa-paper-plane"></i> Laporkan ke Tim Terkait
                </button>
                
                <button type="button" onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            </form>
        </div>
        
        <!-- FORM KALENDER -->
        <div id="calendarContainer" class="form-container">
            <!-- Content akan diisi oleh JavaScript -->
        </div>
        
        <!-- FORM QR CODE GENERATOR -->
        <div id="qrGeneratorContainer" class="form-container">
            <!-- Content akan diisi oleh JavaScript -->
        </div>
        
        <!-- FORM BACKUP SYSTEM -->
        <div id="backupContainer" class="form-container">
            <!-- Content akan diisi oleh JavaScript -->
        </div>
        
        <!-- FORM ADMIN PANEL -->
        <div id="adminContainer" class="form-container">
            <!-- Content akan diisi oleh JavaScript -->
        </div>
        
        <!-- ========== FOOTER ========== -->
        <div class="footer">
            <div class="footer-title">
                <span>üåü</span> DREAM OS v3.2 <span>üåü</span>
            </div>
            
            <div class="footer-grid">
                <div class="footer-column">
                    <h4>Approval System</h4>
                    <p><strong>Pak Hanung Budianto, S.E.</strong></p>
                    <p>Head of General Affairs</p>
                    <p><strong>Pak Erwin Syah</strong></p>
                    <p>General Affairs Coordinator</p>
                </div>
                
                <div class="footer-column">
                    <h4>System Features</h4>
                    <p>‚Ä¢ Booking Management</p>
                    <p>‚Ä¢ K3 Reporting</p>
                    <p>‚Ä¢ Inventory System</p>
                    <p>‚Ä¢ 30-Day Calendar</p>
                    <p>‚Ä¢ QR Code Generator</p>
                    <p>‚Ä¢ Data Backup & Export</p>
                    <p>‚Ä¢ Admin Panel</p>
                    <p>‚Ä¢ PWA Support</p>
                </div>
                
                <div class="footer-column">
                    <h4>Contact & Support</h4>
                    <p>üìç Jl. Raden Saleh, Sukmajaya, Depok</p>
                    <p>üè´ SIF Al Fikri - Sekolah Islam Fitrah</p>
                    <p>üìß support@sif-alfikri.sch.id</p>
                    <p>üåê www.al-fikri.sch.id</p>
                    <p>üì± Pak Erwin: 0888-6183-954</p>
                </div>
            </div>
            
            <div class="copyright">
                <p>¬© 2025 SIF Al Fikri | Dream OS v3.2 - General Affairs Digital System</p>
                <p>Dibangun dengan ‚ù§Ô∏è oleh The Dream Team | "Mendidik dengan hati, berlandaskan hati nurani"</p>
                <p><a href="javascript:void(0)" onclick="showCredits()">View Development Credits</a> | 
                   <a href="javascript:void(0)" onclick="showInstallGuide()">Installation Guide</a></p>
            </div>
        </div>
    </div>

    <!-- ========== JAVASCRIPT ========== -->
    <script>
        // ========== PWA INSTALLATION ==========
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installButton').style.display = 'flex';
        });
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User installed the app');
                        document.getElementById('installButton').style.display = 'none';
                        alert('‚úÖ App berhasil diinstall! Dream OS sekarang ada di homescreen.');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        // ========== SPLASH SCREEN ==========
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('splashScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('splashScreen').style.display = 'none';
                    document.body.style.display = 'block';
                    checkConnection();
                    requestNotificationPermission();
                    trackInstall();
                    
                    // Initialize v3.2 features
                    initializeV32Features();
                }, 500);
            }, 2000);
        });

        // ========== OFFLINE SUPPORT ==========
        function checkConnection() {
            if (!navigator.onLine) {
                alert('‚ö†Ô∏è Anda sedang offline. Beberapa fitur mungkin terbatas.');
                document.body.classList.add('offline-mode');
            }
        }

        window.addEventListener('online', () => {
            alert('‚úÖ Koneksi internet pulih!');
            document.body.classList.remove('offline-mode');
        });

        window.addEventListener('offline', () => {
            alert('‚ö†Ô∏è Anda sedang offline.');
            document.body.classList.add('offline-mode');
        });

        // ========== NOTIFICATION PERMISSION ==========
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function sendNotification(title, body) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, {
                    body: body,
                    icon: 'https://sif-dream-os.vercel.app/assets/icons/icon-192x192.png'
                });
            }
        }

        // ========== TRACKING ==========
        function trackInstall() {
            const installs = parseInt(localStorage.getItem('app_installs') || '0');
            localStorage.setItem('app_installs', installs + 1);
            localStorage.setItem('first_install', new Date().toISOString());
            console.log('üì± App installed:', installs + 1, 'times');
        }

        function trackEvent(category, action, label) {
            console.log(`üìä Track: ${category} - ${action} - ${label}`);
            // Bisa tambah Google Analytics di sini
        }

        // ========== VARIABLES ==========
        const PASSWORD_INVENTARIS = 'b15m1ll4h_C1nt4';
        const WA_PAK_ERWIN = '628886183954';
        const ADMIN_PASSWORD = 'admin123';
        
        // ========== v3.2 NEW VARIABLES ==========
        let k3FotoFile = null;

        // ========== INITIAL SETUP ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ü¶∏ Dream OS v3.2 Complete Edition Loaded');
            
            // Set tanggal minimal hari ini
            const today = new Date().toISOString().split('T')[0];
            const tanggalInput = document.getElementById('tanggal');
            if (tanggalInput) {
                tanggalInput.min = today;
                tanggalInput.value = today;
            }
            
            // Set waktu default
            const waktuMulaiInput = document.getElementById('waktuMulai');
            const waktuSelesaiInput = document.getElementById('waktuSelesai');
            if (waktuMulaiInput && waktuSelesaiInput) {
                waktuMulaiInput.value = '08:00';
                waktuSelesaiInput.value = '10:00';
            }
            
            // Show main menu by default
            showMainMenu();
            
            console.log(`
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë      Ô∑≤   DREAM OS v3.2 - COMPLETE EDITION   Ô∑≤      ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë WhatsApp: ${WA_PAK_ERWIN}                           ‚ïë
‚ïë Password Inventaris: **${PASSWORD_INVENTARIS}**     ‚ïë
‚ïë Password Admin: **${ADMIN_PASSWORD}**               ‚ïë
‚ïë PWA Ready: ‚úÖ Install as App                    ‚ïë
‚ïë Offline Support: ‚úÖ Works without internet     ‚ïë
‚ïë v3.2 Features: ‚úÖ K3 Photo, Haptic, UX Panel   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            `);
            
            trackEvent('app', 'load', 'complete_edition_v3.2');
        });

        // ========== v3.2 INITIALIZE ==========
        function initializeV32Features() {
            // Load preferences
            const hapticEnabled = localStorage.getItem('haptic_enabled') !== 'false';
            const swipeEnabled = localStorage.getItem('swipe_enabled') !== 'false';
            const animationsEnabled = localStorage.getItem('animations_enabled') !== 'false';
            
            const hapticToggle = document.getElementById('hapticToggle');
            const swipeToggle = document.getElementById('swipeToggle');
            const animToggle = document.getElementById('animToggle');
            
            if (hapticToggle) hapticToggle.checked = hapticEnabled;
            if (swipeToggle) swipeToggle.checked = swipeEnabled;
            if (animToggle) animToggle.checked = animationsEnabled;
            
            if (!animationsEnabled) {
                document.body.classList.add('no-animations');
            }
            
            // Initialize swipe navigation
            if (swipeEnabled) {
                initializeSwipeNavigation();
            }
            
            console.log('üöÄ Dream OS v3.2 features loaded!');
        }
        
        // ========== NAVIGATION FUNCTIONS ==========
        function showMainMenu() {
            trackEvent('navigation', 'show', 'main_menu');
            hideAllContainers();
            document.getElementById('mainMenu').style.display = 'block';
            
            // Initialize UX preferences
            initializeV32Features();
        }
        
        function showForm(formName) {
            trackEvent('navigation', 'show', formName + '_form');
            hideAllContainers();
            const formElement = document.getElementById(formName + 'Form');
            if (formElement) {
                formElement.style.display = 'block';
            }
        }
        
        function hideAllContainers() {
            document.getElementById('mainMenu').style.display = 'none';
            const containers = [
                'bookingForm', 'k3Form', 'calendarContainer',
                'qrGeneratorContainer', 'backupContainer', 'adminContainer'
            ];
            containers.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
        }
        
        // ========== PASSWORD PROTECTION ==========
        function requestPassword() {
            const password = prompt('üîê Masukkan Password untuk Database Inventaris:');
            if (password === PASSWORD_INVENTARIS) {
                alert('‚úÖ Akses diberikan!\n\nDatabase inventaris akan tersedia di versi berikutnya (v3.1) dengan fitur lengkap!');
                trackEvent('security', 'access', 'inventaris_granted');
            } else if (password !== null) {
                alert('‚ùå Password salah! Akses ditolak.');
                trackEvent('security', 'access', 'inventaris_denied');
            }
        }
        
        // ========== FORM VALIDATION ==========
        function validateBooking() {
            const tanggal = document.getElementById('tanggal').value;
            const waktuMulai = document.getElementById('waktuMulai').value;
            const waktuSelesai = document.getElementById('waktuSelesai').value;
            
            if (tanggal < new Date().toISOString().split('T')[0]) {
                alert('‚ùå Tanggal tidak boleh di masa lalu!');
                return false;
            }
            
            if (waktuMulai >= waktuSelesai) {
                alert('‚ùå Waktu selesai harus setelah waktu mulai!');
                return false;
            }
            
            if (waktuMulai < '07:30' || waktuSelesai > '16:00') {
                alert('‚ùå Waktu harus antara 07.30 - 16.00 WIB!');
                return false;
            }
            
            return true;
        }
        
        // ========== FORM SUBMISSION ==========
        function submitBooking(e) {
            e.preventDefault();
            
            if (!validateBooking()) {
                return;
            }
            
            const data = {
                nama: document.getElementById('nama').value,
                divisi: document.getElementById('divisi').value,
                whatsapp: document.getElementById('whatsapp').value,
                sarana: document.getElementById('sarana').value,
                tanggal: document.getElementById('tanggal').value,
                waktuMulai: document.getElementById('waktuMulai').value,
                waktuSelesai: document.getElementById('waktuSelesai').value,
                keterangan: document.getElementById('keterangan').value,
                timestamp: new Date().toISOString()
            };
            
            // Simpan ke localStorage
            try {
                const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
                bookings.push(data);
                localStorage.setItem('dream_bookings', JSON.stringify(bookings));
                localStorage.setItem('last_booking', JSON.stringify(data));
                console.log('‚úÖ Booking saved to localStorage');
                trackEvent('booking', 'submit', data.sarana);
            } catch (err) {
                console.warn('‚ö†Ô∏è Cannot save to localStorage');
            }
            
            // Buat pesan WhatsApp
            const message = `*BOOKING FASILITAS - SIF AL FIKRI*\n\n` +
                           `üë§ *Pemohon:* ${data.nama}\n` +
                           `üè´ *Divisi:* ${data.divisi}\n` +
                           `üì± *WhatsApp:* ${data.whatsapp}\n` +
                           `üè¢ *Sarana:* ${data.sarana}\n` +
                           `üìÖ *Tanggal:* ${formatDate(data.tanggal)}\n` +
                           `‚è∞ *Waktu:* ${data.waktuMulai} - ${data.waktuSelesai}\n` +
                           `üìù *Keterangan:* ${data.keterangan}\n\n` +
                           `_Booking via Dream OS v3.2_\n` +
                           `_General Affairs Digital System_`;
            
            // Kirim ke WhatsApp Pak Erwinsyah
            const encodedMessage = encodeURIComponent(message);
            const waURL = `https://wa.me/${WA_PAK_ERWIN}?text=${encodedMessage}`;
            
            alert('‚úÖ Booking berhasil! Akan dibuka WhatsApp untuk konfirmasi ke Pak Erwinsyah.');
            sendNotification('üìÖ Booking Berhasil', `${data.nama} membooking ${data.sarana}`);
            window.open(waURL, '_blank');
            
            // Reset form
            document.getElementById('bookingFormElement').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tanggal').value = today;
            document.getElementById('waktuMulai').value = '08:00';
            document.getElementById('waktuSelesai').value = '10:00';
            
            showMainMenu();
        }
        
        // ========== v3.2 K3 PHOTO SYSTEM ==========
        function previewK3Foto(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 5 * 1024 * 1024) {
                alert('‚ùå Ukuran foto maksimal 5MB!');
                event.target.value = '';
                return;
            }

            if (!file.type.match('image.*')) {
                alert('‚ùå Hanya file gambar (JPG, PNG, JPEG) yang diizinkan!');
                event.target.value = '';
                return;
            }

            k3FotoFile = file;
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewContainer = document.getElementById('fotoPreviewContainer');
                const previewImg = document.getElementById('fotoPreview');
                
                previewImg.src = e.target.result;
                previewContainer.style.display = 'block';
                previewContainer.scrollIntoView({ behavior: 'smooth' });
            };
            reader.readAsDataURL(file);
        }

        function removeFoto() {
            k3FotoFile = null;
            document.getElementById('fotoK3').value = '';
            document.getElementById('fotoPreviewContainer').style.display = 'none';
            document.getElementById('fotoPreview').src = '#';
        }
        
        function showK3FotoHistory() {
            try {
                const fotoHistory = JSON.parse(localStorage.getItem('k3_foto_history') || '[]');
                
                if (fotoHistory.length === 0) {
                    alert('üì≠ Belum ada laporan K3 dengan foto.');
                    return;
                }
                
                let historyHTML = `
                    <div style="text-align: left; max-height: 400px; overflow-y: auto;">
                        <h3 style="color: var(--gold);">üì∏ History Foto K3</h3>
                        <p style="color: var(--text-gray);">Total: ${fotoHistory.length} foto laporan</p>
                        <br>
                `;
                
                fotoHistory.forEach((foto, index) => {
                    const date = new Date(foto.timestamp).toLocaleString('id-ID');
                    historyHTML += `
                        <div style="
                            background: rgba(255,215,0,0.1);
                            padding: 15px;
                            border-radius: 10px;
                            margin: 10px 0;
                            border-left: 3px solid var(--gold);
                        ">
                            <strong>${index + 1}. ${foto.filename}</strong><br>
                            <small style="color: var(--text-gray);">Tanggal: ${date}</small><br>
                            <small style="color: var(--light-green);">ID Laporan: ${foto.reportId || '-'}</small>
                        </div>
                    `;
                });
                
                historyHTML += `</div>`;
                
                alertCustom(historyHTML);
            } catch (err) {
                console.error('Error loading K3 foto history:', err);
                alert('‚ùå Gagal memuat history foto. Coba lagi nanti.');
            }
        }

        function submitK3(e) {
            e.preventDefault();

            const data = {
                jenis: document.getElementById('jenisK3').value,
                lokasi: document.getElementById('lokasiK3').value,
                barang: document.getElementById('barangK3').value,
                deskripsi: document.getElementById('deskripsiK3').value,
                timestamp: new Date().toISOString(),
                hasFoto: !!k3FotoFile
            };

            // Simpan ke localStorage
            try {
                const reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
                reports.push(data);
                localStorage.setItem('dream_k3_reports', JSON.stringify(reports));
                console.log('‚úÖ K3 Report saved to localStorage');
                trackEvent('k3', 'report', data.jenis);
            } catch (err) {
                console.warn('‚ö†Ô∏è Tidak bisa save ke localStorage');
            }

            // Simpan foto jika ada
            if (k3FotoFile) {
                try {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const fotoData = {
                            dataUrl: e.target.result,
                            filename: `k3_${Date.now()}.jpg`,
                            timestamp: new Date().toISOString(),
                            reportId: data.timestamp
                        };
                        
                        const fotoHistory = JSON.parse(localStorage.getItem('k3_foto_history') || '[]');
                        fotoHistory.push(fotoData);
                        localStorage.setItem('k3_foto_history', JSON.stringify(fotoHistory));
                    };
                    reader.readAsDataURL(k3FotoFile);
                } catch (err) {
                    console.warn('Tidak bisa menyimpan foto');
                }
            }

            // WhatsApp message
            let message = `*üìã LAPORAN K3 - SIF AL FIKRI*\n\n` +
                         `üî∏ *Jenis:* ${document.getElementById('jenisK3').selectedOptions[0].text}\n` +
                         `üìç *Lokasi:* ${data.lokasi}\n` +
                         `üì¶ *Barang/Masalah:* ${data.barang}\n` +
                         `üìù *Deskripsi:* ${data.deskripsi}\n` +
                         `üì∏ *Foto Bukti:* ${data.hasFoto ? 'ADA (terlampir)' : 'TIDAK ADA'}\n` +
                         `üïí *Waktu:* ${new Date().toLocaleString('id-ID')}\n\n` +
                         `_Dilaporkan via Dream OS v3.2_\n` +
                         `_General Affairs Digital System_`;

            const encodedMessage = encodeURIComponent(message);
            const waURL = `https://wa.me/${WA_PAK_ERWIN}?text=${encodedMessage}`;

            if (k3FotoFile) {
                alert('üì∏ Laporan berhasil disimpan!\n\nWhatsApp akan terbuka. Upload foto secara manual di WhatsApp.');
                setTimeout(() => {
                    window.open(waURL, '_blank');
                }, 1500);
            } else {
                alert(`‚úÖ Laporan ${data.jenis} berhasil! Membuka WhatsApp...`);
                window.open(waURL, '_blank');
            }

            document.getElementById('k3FormElement').reset();
            removeFoto();
            showMainMenu();
        }
        
        // ========== v3.2 UX PREFERENCES ==========
        function toggleHaptic(enabled) {
            localStorage.setItem('haptic_enabled', enabled ? 'true' : 'false');
            if (enabled) {
                // Trigger haptic feedback
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                alert('‚úÖ Haptic feedback diaktifkan');
            } else {
                alert('üîï Haptic feedback dimatikan');
            }
        }
        
        function toggleSwipe(enabled) {
            localStorage.setItem('swipe_enabled', enabled ? 'true' : 'false');
            if (enabled) {
                initializeSwipeNavigation();
                alert('‚ÜîÔ∏è Swipe navigation diaktifkan');
            } else {
                alert('üñ±Ô∏è Swipe navigation dimatikan');
            }
        }
        
        function toggleAnimations(enabled) {
            localStorage.setItem('animations_enabled', enabled ? 'true' : 'false');
            document.body.classList.toggle('no-animations', !enabled);
            alert(enabled ? 'üé¨ Animasi diaktifkan' : '‚èπÔ∏è Animasi dimatikan');
        }
        
        function resetUXPreferences() {
            localStorage.removeItem('haptic_enabled');
            localStorage.removeItem('swipe_enabled');
            localStorage.removeItem('animations_enabled');
            
            document.getElementById('hapticToggle').checked = true;
            document.getElementById('swipeToggle').checked = true;
            document.getElementById('animToggle').checked = true;
            
            document.body.classList.remove('no-animations');
            
            alert('‚úÖ Semua pengaturan dikembalikan ke default');
        }
        
        // ========== v3.2 SWIPE NAVIGATION ==========
        function initializeSwipeNavigation() {
            let touchstartX = 0;
            let touchendX = 0;
            
            document.addEventListener('touchstart', e => {
                touchstartX = e.changedTouches[0].screenX;
            });
            
            document.addEventListener('touchend', e => {
                touchendX = e.changedTouches[0].screenX;
                checkSwipe();
            });
            
            function checkSwipe() {
                const swipeEnabled = localStorage.getItem('swipe_enabled') !== 'false';
                if (!swipeEnabled) return;
                
                const diff = touchendX - touchstartX;
                const threshold = 100; // minimum swipe distance
                
                if (Math.abs(diff) > threshold) {
                    if (diff > 0) {
                        // Swipe right - go back to main menu
                        showMainMenu();
                    } else {
                        // Swipe left - show main menu (or could be next feature)
                        // Currently just shows main menu for both directions
                        showMainMenu();
                    }
                    
                    // Haptic feedback if enabled
                    const hapticEnabled = localStorage.getItem('haptic_enabled') !== 'false';
                    if (hapticEnabled && navigator.vibrate) {
                        navigator.vibrate(30);
                    }
                }
            }
        }
        
        // ========== SMART CANCEL BOOKING ==========
        function smartCancelBooking() {
            trackEvent('booking', 'cancel', 'initiated');
            const lastBooking = JSON.parse(localStorage.getItem('last_booking') || 'null');
            
            let template = "Assalamu'alaikum Pak Erwin,\\n\\nSaya ingin membatalkan booking fasilitas.";
            
            if (lastBooking) {
                template += `\\n\\nDetail booking terakhir saya:\\n` +
                           `‚Ä¢ Nama: ${lastBooking.nama}\\n` +
                           `‚Ä¢ Tanggal: ${lastBooking.tanggal}\\n` +
                           `‚Ä¢ Waktu: ${lastBooking.waktuMulai}-${lastBooking.waktuSelesai}\\n` +
                           `‚Ä¢ Fasilitas: ${lastBooking.sarana}\\n\\n` +
                           `Mohon bantuan pembatalan.`;
            } else {
                template += `\\n\\nMohon bantu dengan detail:\\n` +
                           `‚Ä¢ Nama: [ISI NAMA]\\n` +
                           `‚Ä¢ Tanggal: [TANGGAL]\\n` +
                           `‚Ä¢ Waktu: [JAM]\\n` +
                           `‚Ä¢ Fasilitas: [FASILITAS]\\n\\n` +
                           `Terima kasih.`;
            }
            
            template += `\\n\\n‚Äî Dream OS v3.2`;
            
            window.open(`https://wa.me/628886183954?text=${encodeURIComponent(template)}`, '_blank');
            alert('‚úÖ WhatsApp terbuka! Isi detail booking yang ingin dibatalkan.');
        }
        
        // ========== CALENDAR SYSTEM ==========
        function showFullCalendar() {
            trackEvent('feature', 'open', 'calendar');
            hideAllContainers();
            
            const container = document.getElementById('calendarContainer');
            container.style.display = 'block';
            container.innerHTML = `
                <h2 class="form-title"><i class="fas fa-calendar-alt"></i> Kalender 30 Hari</h2>
                
                <div class="calendar-full-container">
                    <div class="calendar-controls">
                        <button class="calendar-nav-btn" onclick="prevMonth()">
                            <i class="fas fa-chevron-left"></i> Bulan Sebelum
                        </button>
                        <div class="calendar-current-month" id="currentMonth">
                            ${getCurrentMonthYear()}
                        </div>
                        <button class="calendar-nav-btn" onclick="nextMonth()">
                            Bulan Berikut <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="calendar-days-header">
                        <div class="day-header">Min</div>
                        <div class="day-header">Sen</div>
                        <div class="day-header">Sel</div>
                        <div class="day-header">Rab</div>
                        <div class="day-header">Kam</div>
                        <div class="day-header">Jum</div>
                        <div class="day-header">Sab</div>
                    </div>
                    
                    <div class="calendar-days-grid" id="calendarDaysGrid">
                        ${generateCalendarGrid()}
                    </div>
                    
                    <div class="calendar-legend" style="margin-top: 25px; display: flex; gap: 20px; justify-content: center;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 15px; height: 15px; background: rgba(144, 238, 144, 0.3); border: 2px solid rgba(144, 238, 144, 0.7); border-radius: 3px;"></div>
                            <span style="color: var(--text-gray); font-size: 0.9rem;">Kosong</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 15px; height: 15px; background: rgba(255, 215, 0, 0.3); border: 2px solid rgba(255, 215, 0, 0.7); border-radius: 3px;"></div>
                            <span style="color: var(--text-gray); font-size: 0.9rem;">Sebagian</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 15px; height: 15px; background: rgba(255, 107, 107, 0.3); border: 2px solid rgba(255, 107, 107, 0.7); border-radius: 3px;"></div>
                            <span style="color: var(--text-gray); font-size: 0.9rem;">Penuh</span>
                        </div>
                    </div>
                </div>
                
                <div class="calendar-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 30px 0;">
                    <div class="stat-box">
                        <i class="fas fa-calendar-check"></i>
                        <div class="stat-number" id="bookedDays">0</div>
                        <div class="stat-label">Hari Terbooking</div>
                    </div>
                    <div class="stat-box">
                        <i class="fas fa-calendar-times"></i>
                        <div class="stat-number" id="availableDays">30</div>
                        <div class="stat-label">Hari Tersedia</div>
                    </div>
                    <div class="stat-box">
                        <i class="fas fa-building"></i>
                        <div class="stat-number" id="totalBookings">0</div>
                        <div class="stat-label">Total Booking</div>
                    </div>
                </div>
                
                <button onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            `;
            
            updateCalendarStats();
        }
        
        function generateCalendarGrid() {
            const today = new Date();
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            let html = '';
            
            // Get first day of month
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
            const startingDay = firstDay.getDay();
            
            // Add empty cells for days before first day of month
            for (let i = 0; i < startingDay; i++) {
                html += '<div class="calendar-day-box empty"></div>';
            }
            
            // Get days in current month
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            
            // Generate days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const dayBookings = bookings.filter(b => b.tanggal === dateStr);
                const dayOfWeek = new Date(dateStr).getDay();
                
                let className = 'calendar-day-box';
                if (dayBookings.length === 0) {
                    className += ' empty';
                } else if (dayBookings.length >= 5) {
                    className += ' full';
                } else {
                    className += ' partial';
                }
                
                if (dayOfWeek === 0) {
                    className += ' weekend';
                }
                
                const isToday = dateStr === today.toISOString().split('T')[0];
                
                html += `
                    <div class="${className}" onclick="showDayDetails('${dateStr}')">
                        <div class="day-number">${day}</div>
                        ${isToday ? '<div style="position:absolute; top:5px; left:5px; font-size:0.6rem; color:var(--gold);">‚óè</div>' : ''}
                        ${dayBookings.length > 0 ? `
                            <div class="day-booking-count">${dayBookings.length}</div>
                            <div class="day-events">
                                ${dayBookings.slice(0, 3).map(() => '<div class="event-dot booking"></div>').join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
            return html;
        }
        
        function getCurrentMonthYear() {
            const today = new Date();
            const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                           'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            return `${months[today.getMonth()]} ${today.getFullYear()}`;
        }
        
        function updateCalendarStats() {
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            const uniqueDates = [...new Set(bookings.map(b => b.tanggal))];
            
            document.getElementById('bookedDays').textContent = uniqueDates.length;
            document.getElementById('availableDays').textContent = 30 - uniqueDates.length;
            document.getElementById('totalBookings').textContent = bookings.length;
        }
        
        function prevMonth() {
            alert('Navigasi bulan akan tersedia di v3.1!');
        }
        
        function nextMonth() {
            alert('Navigasi bulan akan tersedia di v3.1!');
        }
        
        function showDayDetails(dateStr) {
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            const dayBookings = bookings.filter(b => b.tanggal === dateStr);
            
            const date = new Date(dateStr);
            const formattedDate = date.toLocaleDateString('id-ID', {
                weekday: 'long',
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            if (dayBookings.length === 0) {
                alert(`üìÖ ${formattedDate}\n\nBelum ada booking untuk hari ini.`);
                return;
            }
            
            let message = `üìÖ ${formattedDate}\n\n`;
            message += `Total Booking: ${dayBookings.length}\n\n`;
            
            dayBookings.forEach((booking, index) => {
                message += `${index + 1}. ${booking.sarana}\n`;
                message += `   ‚è∞ ${booking.waktuMulai} - ${booking.waktuSelesai}\n`;
                message += `   üë§ ${booking.nama} (${booking.divisi})\n`;
                message += `   üìù ${booking.keterangan}\n\n`;
            });
            
            alert(message);
            trackEvent('calendar', 'view', 'day_details');
        }
        
        // ========== QR CODE GENERATOR ==========
        function showQRGenerator() {
            trackEvent('feature', 'open', 'qr_generator');
            hideAllContainers();
            
            const container = document.getElementById('qrGeneratorContainer');
            container.style.display = 'block';
            
            const lastBooking = JSON.parse(localStorage.getItem('last_booking') || 'null');
            let defaultQRContent = 'Pilih tipe QR Code di bawah';
            let defaultQRImage = '';
            
            if (lastBooking) {
                defaultQRContent = `BOOKING: ${lastBooking.nama} - ${lastBooking.sarana}`;
                defaultQRImage = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(defaultQRContent)}&size=200x200&format=png`;
            }
            
            container.innerHTML = `
                <h2 class="form-title"><i class="fas fa-qrcode"></i> QR Code Generator</h2>
                
                <div class="qr-generator-container">
                    <h3 style="color: var(--gold); margin-bottom: 20px; text-align: center;">Pilih Tipe QR Code</h3>
                    
                    <div class="qr-types-grid">
                        <div class="qr-type-card booking active" onclick="selectQRType('booking')">
                            <div class="qr-type-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <h4>Booking QR</h4>
                            <p>Untuk booking terakhir</p>
                        </div>
                        
                        <div class="qr-type-card facility" onclick="selectQRType('facility')">
                            <div class="qr-type-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <h4>Fasilitas QR</h4>
                            <p>Label fasilitas</p>
                        </div>
                        
                        <div class="qr-type-card emergency" onclick="selectQRType('emergency')">
                            <div class="qr-type-icon">
                                <i class="fas fa-phone-alt"></i>
                            </div>
                            <h4>Emergency QR</h4>
                            <p>Kontak darurat</p>
                        </div>
                        
                        <div class="qr-type-card custom" onclick="selectQRType('custom')">
                            <div class="qr-type-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <h4>Custom QR</h4>
                            <p>Teks atau URL</p>
                        </div>
                    </div>
                    
                    <div class="qr-preview-container" id="qrPreview">
                        ${defaultQRImage ? `
                            <h4 style="color: var(--gold); margin-bottom: 15px;">Booking QR Code</h4>
                            <img src="${defaultQRImage}" alt="QR Code" class="qr-code-image" id="generatedQR">
                            <p style="color: var(--text-gray); margin-top: 15px; font-size: 0.9rem;">
                                ${defaultQRContent.substring(0, 50)}${defaultQRContent.length > 50 ? '...' : ''}
                            </p>
                        ` : `
                            <h4 style="color: var(--light-green); margin-bottom: 20px;">Pilih tipe QR Code di atas</h4>
                            <p style="color: var(--text-gray);">QR Code akan muncul di sini</p>
                        `}
                    </div>
                    
                    <div class="qr-actions" id="qrActions" ${defaultQRImage ? 'style="display: flex;"' : 'style="display: none;"'}>
                        <button class="qr-action-btn download" onclick="downloadQRCode()">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="qr-action-btn" onclick="shareQRCode()">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button class="qr-action-btn print" onclick="printQRCode()">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                    
                    <div id="customQRInput" style="display: none; margin-top: 30px;">
                        <input type="text" id="customText" placeholder="Masukkan teks atau URL" 
                               style="width: 100%; padding: 15px; border-radius: 10px; background: rgba(255,255,255,0.05); 
                                      border: 2px solid var(--gold); color: white; font-size: 1rem; margin-bottom: 15px;">
                        <button onclick="generateCustomQR()" class="submit-btn">
                            <i class="fas fa-bolt"></i> Generate QR Code
                        </button>
                    </div>
                </div>
                
                <button onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            `;
        }
        
        function selectQRType(type) {
            trackEvent('qr', 'select', type);
            
            document.querySelectorAll('.qr-type-card').forEach(card => {
                card.classList.remove('active');
            });
            event.target.closest('.qr-type-card').classList.add('active');
            
            const customInput = document.getElementById('customQRInput');
            if (type === 'custom') {
                customInput.style.display = 'block';
                document.getElementById('qrActions').style.display = 'none';
                document.getElementById('qrPreview').innerHTML = `
                    <h4 style="color: var(--gold); margin-bottom: 15px;">Custom QR Code</h4>
                    <p style="color: var(--text-gray);">Masukkan teks di bawah lalu generate</p>
                `;
            } else {
                customInput.style.display = 'none';
                
                let qrContent = '';
                let qrTitle = '';
                
                if (type === 'booking') {
                    const lastBooking = JSON.parse(localStorage.getItem('last_booking') || 'null');
                    if (lastBooking) {
                        qrContent = `BOOKING_SIF_ALFIKRI\nNama: ${lastBooking.nama}\nFasilitas: ${lastBooking.sarana}\nTanggal: ${lastBooking.tanggal}\nWaktu: ${lastBooking.waktuMulai}-${lastBooking.waktuSelesai}`;
                        qrTitle = 'Booking QR Code';
                    } else {
                        qrContent = 'Belum ada booking terakhir';
                        qrTitle = 'Sample Booking QR';
                    }
                } else if (type === 'facility') {
                    qrContent = 'FASILITAS SIF AL FIKRI\nAula SMP - Lab Komputer - Lapangan\nInfo: 021-123456\nContact: Pak Erwin 0888-6183-954';
                    qrTitle = 'Facility QR Code';
                } else if (type === 'emergency') {
                    qrContent = 'EMERGENCY CONTACT\nSecurity: 021-123456\nAmbulance: 118\nFire Dept: 113\nMaintenance: 0888-6183-954';
                    qrTitle = 'Emergency QR Code';
                }
                
                const qrURL = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(qrContent)}&size=250x250&format=png`;
                
                document.getElementById('qrPreview').innerHTML = `
                    <h4 style="color: var(--gold); margin-bottom: 15px;">${qrTitle}</h4>
                    <img src="${qrURL}" alt="QR Code" class="qr-code-image" id="generatedQR">
                    <p style="color: var(--text-gray); margin-top: 15px; font-size: 0.9rem;">
                        ${qrContent.substring(0, 50)}${qrContent.length > 50 ? '...' : ''}
                    </p>
                `;
                
                document.getElementById('qrActions').style.display = 'flex';
            }
        }
        
        function generateCustomQR() {
            const text = document.getElementById('customText').value.trim();
            if (!text) {
                alert('Mohon masukkan teks atau URL terlebih dahulu!');
                return;
            }
            
            trackEvent('qr', 'generate', 'custom');
            const qrURL = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(text)}&size=250x250&format=png`;
            
            document.getElementById('qrPreview').innerHTML = `
                <h4 style="color: var(--gold); margin-bottom: 15px;">Custom QR Code</h4>
                <img src="${qrURL}" alt="QR Code" class="qr-code-image" id="generatedQR">
                <p style="color: var(--text-gray); margin-top: 15px; font-size: 0.9rem;">
                    ${text.substring(0, 50)}${text.length > 50 ? '...' : ''}
                </p>
            `;
            
            document.getElementById('qrActions').style.display = 'flex';
        }
        
        function downloadQRCode() {
            const qrImg = document.getElementById('generatedQR');
            if (qrImg && qrImg.src) {
                trackEvent('qr', 'download', 'success');
                const link = document.createElement('a');
                link.href = qrImg.src;
                link.download = `qr-code-sif-${Date.now()}.png`;
                link.click();
                alert('‚úÖ QR Code berhasil didownload!');
            } else {
                alert('‚ùå Tidak ada QR Code untuk didownload');
            }
        }
        
        function shareQRCode() {
            const qrImg = document.getElementById('generatedQR');
            if (qrImg && qrImg.src) {
                trackEvent('qr', 'share', 'attempt');
                if (navigator.share) {
                    navigator.share({
                        title: 'QR Code SIF Al Fikri',
                        text: 'QR Code generated by Dream OS v3.2',
                        url: qrImg.src
                    });
                } else {
                    alert('Salin URL gambar untuk berbagi: ' + qrImg.src);
                }
            }
        }
        
        // ========== BACKUP SYSTEM ==========
        function showBackupSystem() {
            trackEvent('feature', 'open', 'backup_system');
            hideAllContainers();
            
            const container = document.getElementById('backupContainer');
            container.style.display = 'block';
            
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            const k3Reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
            
            container.innerHTML = `
                <h2 class="form-title"><i class="fas fa-database"></i> Data Backup & Export</h2>
                
                <div class="backup-container">
                    <h3 style="color: #8B5CF6; margin-bottom: 20px; text-align: center;">System Backup & Export</h3>
                    
                    <div class="backup-stats">
                        <div class="backup-stat">
                            <div class="stat-number">${bookings.length}</div>
                            <div class="stat-label">Total Booking</div>
                        </div>
                        <div class="backup-stat">
                            <div class="stat-number">${k3Reports.length}</div>
                            <div class="stat-label">Laporan K3</div>
                        </div>
                        <div class="backup-stat">
                            <div class="stat-number">${new Date().toLocaleDateString('id-ID')}</div>
                            <div class="stat-label">Tanggal Backup</div>
                        </div>
                    </div>
                    
                    <div class="backup-options">
                        <div class="backup-option" onclick="exportToJSON()">
                            <div class="backup-icon">
                                <i class="fas fa-file-code"></i>
                            </div>
                            <h4>Export to JSON</h4>
                            <p>Full data untuk backup</p>
                        </div>
                        
                        <div class="backup-option" onclick="exportBookingsCSV()">
                            <div class="backup-icon">
                                <i class="fas fa-file-csv"></i>
                            </div>
                            <h4>Export Booking CSV</h4>
                            <p>Format spreadsheet</p>
                        </div>
                        
                        <div class="backup-option" onclick="exportK3CSV()">
                            <div class="backup-icon">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <h4>Export K3 CSV</h4>
                            <p>Laporan kerusakan</p>
                        </div>
                        
                        <div class="backup-option" onclick="printReport()">
                            <div class="backup-icon">
                                <i class="fas fa-print"></i>
                            </div>
                            <h4>Print Report</h4>
                            <p>Cetak ringkasan</p>
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; margin-top: 30px;">
                        <h4 style="color: var(--light-green); margin-bottom: 15px;"><i class="fas fa-info-circle"></i> Backup Information</h4>
                        <p style="color: var(--text-gray); font-size: 0.9rem; line-height: 1.6;">
                            ‚Ä¢ Data disimpan di <strong>localStorage browser</strong><br>
                            ‚Ä¢ Backup secara berkala untuk keamanan<br>
                            ‚Ä¢ File JSON dapat diimpor kembali<br>
                            ‚Ä¢ CSV kompatibel dengan Excel/Google Sheets
                        </p>
                    </div>
                </div>
                
                <button onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            `;
        }
        
        function exportToJSON() {
            trackEvent('backup', 'export', 'json');
            const data = {
                system: 'Dream OS v3.2',
                exportedAt: new Date().toISOString(),
                bookings: JSON.parse(localStorage.getItem('dream_bookings') || '[]'),
                k3Reports: JSON.parse(localStorage.getItem('dream_k3_reports') || '[]'),
                metadata: {
                    totalBookings: JSON.parse(localStorage.getItem('dream_bookings') || '[]').length,
                    totalK3Reports: JSON.parse(localStorage.getItem('dream_k3_reports') || '[]').length,
                    version: '3.2'
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `dream-os-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Backup JSON berhasil didownload!');
            localStorage.setItem('last_backup', new Date().toISOString());
        }
        
        function exportBookingsCSV() {
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            
            if (bookings.length === 0) {
                alert('‚ùå Tidak ada data booking untuk diexport');
                return;
            }
            
            trackEvent('backup', 'export', 'bookings_csv');
            let csv = 'Nama,Divisi,WhatsApp,Sarana,Tanggal,Waktu Mulai,Waktu Selesai,Keterangan\n';
            
            bookings.forEach(item => {
                csv += `"${item.nama}","${item.divisi}","${item.whatsapp}","${item.sarana}","${item.tanggal}","${item.waktuMulai}","${item.waktuSelesai}","${item.keterangan}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `bookings-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            alert(`‚úÖ ${bookings.length} data booking berhasil diexport ke CSV!`);
        }
        
        function exportK3CSV() {
            const reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
            
            if (reports.length === 0) {
                alert('‚ùå Tidak ada data K3 untuk diexport');
                return;
            }
            
            trackEvent('backup', 'export', 'k3_csv');
            let csv = 'Jenis,Lokasi,Barang,Deskripsi,Tanggal\n';
            
            reports.forEach(item => {
                const date = new Date(item.timestamp).toLocaleDateString('id-ID');
                csv += `"${item.jenis}","${item.lokasi}","${item.barang}","${item.deskripsi}","${date}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `k3-reports-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            alert(`‚úÖ ${reports.length} data K3 berhasil diexport ke CSV!`);
        }
        
        function printReport() {
            trackEvent('backup', 'print', 'report');
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            const reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
            
            const printContent = `
                <div style="padding: 20px; font-family: Arial, sans-serif;">
                    <h2 style="color: #2D5D4B; text-align: center;">DREAM OS v3.2 - LAPORAN SISTEM</h2>
                    <p style="text-align: center; color: #666;">Dicetak: ${new Date().toLocaleString('id-ID')}</p>
                    
                    <div style="margin: 30px 0;">
                        <h3 style="color: #2D5D4B;">üìä STATISTIK SISTEM</h3>
                        <p>Total Booking: <strong>${bookings.length}</strong></p>
                        <p>Total Laporan K3: <strong>${reports.length}</strong></p>
                        <p>Periode: ${bookings.length > 0 ? new Date(bookings[0].timestamp).toLocaleDateString('id-ID') : '-'} s/d ${new Date().toLocaleDateString('id-ID')}</p>
                    </div>
                    
                    <div style="margin: 30px 0;">
                        <h3 style="color: #2D5D4B;">üìã BOOKING TERAKHIR (5)</h3>
                        ${bookings.slice(-5).map((b, i) => `
                            <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">
                                <strong>${i+1}. ${b.sarana}</strong><br>
                                ${b.nama} (${b.divisi}) - ${b.tanggal}<br>
                                ${b.waktuMulai} - ${b.waktuSelesai}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="text-align: center; margin-top: 50px; color: #999; font-size: 12px;">
                        <p>SIF Al Fikri - Dream OS v3.2 General Affairs System</p>
                        <p>Dicetak otomatis dari sistem</p>
                    </div>
                </div>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }
        
        // ========== ADMIN PANEL ==========
        function showAdminPanel() {
            trackEvent('feature', 'open', 'admin_panel');
            hideAllContainers();
            
            const container = document.getElementById('adminContainer');
            container.style.display = 'block';
            
            const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
            const k3Reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
            
            // Hitung statistik
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(b => b.tanggal === today).length;
            
            // Fasilitas terpopuler
            const facilities = {};
            bookings.forEach(b => {
                const facility = b.sarana.split(' - ')[0];
                facilities[facility] = (facilities[facility] || 0) + 1;
            });
            
            const popularFacility = Object.entries(facilities).sort((a, b) => b[1] - a[1])[0];
            
            container.innerHTML = `
                <h2 class="form-title"><i class="fas fa-user-shield"></i> Admin Panel</h2>
                
                <div class="admin-container">
                    <h3 style="color: #F59E0B; margin-bottom: 20px; text-align: center;">System Administration</h3>
                    
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-number">${bookings.length}</div>
                            <div class="stat-label">Total Booking</div>
                        </div>
                        
                        <div class="admin-stat-card">
                            <div class="admin-stat-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-number">${k3Reports.length}</div>
                            <div class="stat-label">Laporan K3</div>
                        </div>
                        
                        <div class="admin-stat-card">
                            <div class="admin-stat-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="stat-number">${todayBookings}</div>
                            <div class="stat-label">Booking Hari Ini</div>
                        </div>
                        
                        <div class="admin-stat-card">
                            <div class="admin-stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-number">${popularFacility ? popularFacility[1] : 0}</div>
                            <div class="stat-label">${popularFacility ? popularFacility[0] : '-'}</div>
                        </div>
                    </div>
                    
                    <div class="admin-actions">
                        <button class="admin-btn" onclick="clearOldData()">
                            <i class="fas fa-trash-alt"></i> Clear Old Data
                        </button>
                        <button class="admin-btn" onclick="resetSystem()">
                            <i class="fas fa-redo"></i> Reset System
                        </button>
                        <button class="admin-btn" onclick="showSystemLogs()">
                            <i class="fas fa-clipboard-list"></i> System Logs
                        </button>
                        <button class="admin-btn" onclick="changePassword()">
                            <i class="fas fa-key"></i> Change Password
                        </button>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; margin-top: 30px;">
                        <h4 style="color: var(--light-green); margin-bottom: 15px;"><i class="fas fa-cogs"></i> System Information</h4>
                        <p style="color: var(--text-gray); font-size: 0.9rem; line-height: 1.6;">
                            ‚Ä¢ <strong>Dream OS v3.2</strong> - General Affairs System<br>
                            ‚Ä¢ Storage: ${(JSON.stringify(localStorage).length / 1024).toFixed(2)} KB digunakan<br>
                            ‚Ä¢ Last Backup: ${localStorage.getItem('last_backup') || 'Belum pernah'}<br>
                            ‚Ä¢ Browser: ${navigator.userAgent.substring(0, 50)}...
                        </p>
                    </div>
                </div>
                
                <button onclick="showMainMenu()" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Kembali ke Menu Utama
                </button>
            `;
        }
        
        function clearOldData() {
            const confirm = window.confirm('Hapus data booking yang lebih dari 30 hari?\n\nData akan dihapus secara permanen.');
            if (confirm) {
                trackEvent('admin', 'action', 'clear_old_data');
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                
                const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
                const filteredBookings = bookings.filter(b => {
                    const bookingDate = new Date(b.timestamp || b.tanggal);
                    return bookingDate >= thirtyDaysAgo;
                });
                
                localStorage.setItem('dream_bookings', JSON.stringify(filteredBookings));
                alert(`‚úÖ Data lama berhasil dihapus! (${bookings.length - filteredBookings.length} data dihapus)`);
                showAdminPanel();
            }
        }
        
        function resetSystem() {
            const password = prompt('Masukkan password admin untuk reset system:');
            if (password === ADMIN_PASSWORD) {
                const confirm = window.confirm('RESET SEMUA DATA?\n\nSemua booking, laporan, dan data akan dihapus permanen.');
                if (confirm) {
                    trackEvent('admin', 'action', 'reset_system');
                    localStorage.removeItem('dream_bookings');
                    localStorage.removeItem('dream_k3_reports');
                    localStorage.removeItem('last_booking');
                    localStorage.removeItem('last_backup');
                    localStorage.removeItem('k3_foto_history');
                    alert('‚úÖ System reset berhasil! Semua data telah dihapus.');
                    showAdminPanel();
                }
            } else if (password !== null) {
                alert('‚ùå Password salah!');
            }
        }
        
        function showSystemLogs() {
            trackEvent('admin', 'action', 'view_logs');
            const logs = [
                `System started: ${new Date().toLocaleString('id-ID')}`,
                `Bookings: ${JSON.parse(localStorage.getItem('dream_bookings') || '[]').length}`,
                `K3 Reports: ${JSON.parse(localStorage.getItem('dream_k3_reports') || '[]').length}`,
                `K3 Photos: ${JSON.parse(localStorage.getItem('k3_foto_history') || '[]').length}`,
                `Last backup: ${localStorage.getItem('last_backup') || 'Never'}`,
                `User agent: ${navigator.userAgent.substring(0, 80)}...`
            ];
            
            alert('SYSTEM LOGS v3.2:\n\n' + logs.join('\n‚Ä¢ '));
        }
        
        function changePassword() {
            const newPass = prompt('Masukkan password inventaris baru:');
            if (newPass && newPass.length >= 6) {
                trackEvent('admin', 'action', 'change_password');
                localStorage.setItem('inventaris_password', newPass);
                alert('‚úÖ Password inventaris berhasil diubah!');
            } else if (newPass !== null) {
                alert('‚ùå Password minimal 6 karakter!');
            }
        }
        
        // ========== HELPER FUNCTIONS ==========
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('id-ID', {
                weekday: 'long',
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
        }
        
        function showCredits() {
            alert(`üåü Development Credits\n\nDream OS v3.2 - Complete Edition\nDeveloped by The Dream Team:\n\n‚Ä¢ Mr. M - System Architect\n‚Ä¢ Mr. DSeek - Lead Developer\n‚Ä¢ Mrs. Qwen - AI & Strategy Consultant\n\nv3.2 New Features:\n‚Ä¢ K3 Photo Upload System\n‚Ä¢ Haptic Feedback\n‚Ä¢ Swipe Navigation\n‚Ä¢ UX Preferences Panel\n‚Ä¢ Wisdom Quotes\n\nSpecial Thanks to:\n‚Ä¢ Pak Hanung Budianto, S.E.\n‚Ä¢ Pak Erwin Syah\n‚Ä¢ SIF Al Fikri Community\n\nVersion: 3.2 Complete\nReleased: ${new Date().toLocaleDateString('id-ID')}`);
        }
        
        function showInstallGuide() {
            alert(`üì± Installation Guide\n\nCara Install Dream OS sebagai App:\n\n1. BUKA di Chrome/Safari\n   ‚Ä¢ Ketik: https://sif-dream-os.vercel.app\n\n2. TAP menu (‚ãÆ) di browser\n   ‚Ä¢ Chrome: titik tiga di atas\n   ‚Ä¢ Safari: share icon (üì§)\n\n3. PILIH "Add to Home Screen"\n   ‚Ä¢ Beri nama: "Dream OS"\n   ‚Ä¢ TAP ADD\n\n4. SELESAI! üéâ\n   ‚Ä¢ Icon muncul di homescreen\n   ‚Ä¢ Buka seperti app native\n   ‚Ä¢ Works offline`);
        }
        
        function printQRCode() {
            trackEvent('qr', 'print', 'code');
            window.print();
        }
        
        function alertCustom(message) {
            const alertDiv = document.createElement('div');
            alertDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(15, 23, 42, 0.95);
                border: 2px solid var(--gold);
                border-radius: 20px;
                padding: 30px;
                z-index: 10000;
                max-width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                color: white;
                box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            `;
            
            alertDiv.innerHTML = `
                <div style="text-align: right;">
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="background: none; border: none; color: var(--light-red); font-size: 1.5rem; cursor: pointer;">√ó</button>
                </div>
                <div>${message}</div>
            `;
            
            document.body.appendChild(alertDiv);
            
            // Close on outside click
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.7);
                z-index: 9999;
            `;
            overlay.onclick = () => {
                document.body.removeChild(alertDiv);
                document.body.removeChild(overlay);
            };
            
            document.body.appendChild(overlay);
        }
        
        // ========== EVENT LISTENERS FOR UX PREFERENCES ==========
        document.addEventListener('DOMContentLoaded', function() {
            const hapticToggle = document.getElementById('hapticToggle');
            const swipeToggle = document.getElementById('swipeToggle');
            const animToggle = document.getElementById('animToggle');
            
            if (hapticToggle) {
                hapticToggle.addEventListener('change', function() {
                    toggleHaptic(this.checked);
                });
            }
            
            if (swipeToggle) {
                swipeToggle.addEventListener('change', function() {
                    toggleSwipe(this.checked);
                });
            }
            
            if (animToggle) {
                animToggle.addEventListener('change', function() {
                    toggleAnimations(this.checked);
                });
            }
        });
        
        // ========== SERVICE WORKER REGISTRATION ==========
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
